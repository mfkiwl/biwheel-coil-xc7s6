Version 4
SHEET 1 880 680
WIRE -800 -1488 -816 -1488
WIRE -464 -1488 -736 -1488
WIRE -816 -1440 -816 -1488
WIRE -816 -1440 -1312 -1440
WIRE -816 -1360 -816 -1440
WIRE -800 -1360 -816 -1360
WIRE -640 -1360 -736 -1360
WIRE -1536 -1280 -1776 -1280
WIRE -1408 -1280 -1536 -1280
WIRE -1312 -1280 -1312 -1440
WIRE -1312 -1280 -1328 -1280
WIRE -640 -1280 -640 -1360
WIRE -464 -1280 -464 -1488
WIRE -1536 -1200 -1536 -1280
WIRE -1872 -1168 -1904 -1168
WIRE -1776 -1168 -1776 -1280
WIRE -1776 -1168 -1792 -1168
WIRE -1680 -1168 -1776 -1168
WIRE -1328 -1168 -1344 -1168
WIRE -1312 -1168 -1328 -1168
WIRE -640 -1168 -640 -1200
WIRE -464 -1168 -464 -1200
WIRE -1424 -1120 -1424 -1168
WIRE -1424 -1120 -1536 -1120
WIRE -2368 -1088 -2496 -1088
WIRE -2240 -1088 -2304 -1088
WIRE -2016 -1088 -2160 -1088
WIRE -1328 -1088 -1328 -1168
WIRE -1312 -1088 -1328 -1088
WIRE -2016 -1072 -2016 -1088
WIRE -1904 -1072 -1904 -1168
WIRE -1776 -1056 -1776 -1168
WIRE -1680 -1056 -1680 -1168
WIRE -2496 -992 -2496 -1088
WIRE -2016 -960 -2016 -992
WIRE -1904 -960 -1904 -992
WIRE -1776 -960 -1776 -992
WIRE -1776 -960 -1904 -960
WIRE -1680 -960 -1680 -992
WIRE -1680 -960 -1776 -960
WIRE -1536 -960 -1536 -1008
WIRE -1536 -960 -1680 -960
WIRE -1312 -960 -1312 -1008
WIRE -1312 -960 -1536 -960
WIRE -1904 -928 -1904 -960
WIRE -2496 -864 -2496 -912
WIRE -2496 -864 -2512 -864
WIRE -2016 -864 -2016 -880
WIRE -2992 -784 -2992 -832
WIRE -2992 -672 -2992 -704
WIRE -2784 -672 -2784 -736
WIRE -2992 -560 -2992 -592
WIRE -2784 -560 -2784 -592
FLAG -2992 -560 0
FLAG -2784 -560 0
FLAG -2992 -832 FORCE_SIGNAL
FLAG -2784 -736 RAMP_SIGNAL
FLAG -1904 -928 0
FLAG -2016 -864 0
FLAG -2496 -864 0
FLAG -640 -1168 0
FLAG -464 -1168 0
FLAG -1312 -1168 vcspark
SYMBOL cap -2304 -1104 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL ind2 -2000 -976 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L1
SYMATTR Value 32.1µ
SYMATTR Type ind
SYMBOL ind2 -1920 -976 M180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 22.15m
SYMATTR Type ind
SYMBOL cap -1792 -1056 R0
SYMATTR InstName C4
SYMATTR Value 8.7p
SYMBOL voltage -2784 -688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL(0 0 1u 50 1800u {VRAMP_MAX})
SYMBOL voltage -2992 -688 R0
WINDOW 3 -1031 42 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 1 0 1n 1n {0.5/FORCE_FREQ} {1/FORCE_FREQ} {FORCE_NCYCLES})
SYMATTR InstName V3
SYMBOL res -2032 -976 R0
SYMATTR InstName R1
SYMATTR Value 0.5
SYMBOL bv -2496 -1008 R0
WINDOW 3 -23 298 Left 2
SYMATTR Value V={if( (V(FORCE_SIGNAL)>0.1), V(RAMP_SIGNAL), if( (V(FORCE_SIGNAL) < -0.1), -V(RAMP_SIGNAL), if( (I(R1)>0), V(RAMP_SIGNAL), -V(RAMP_SIGNAL) ) ))}
SYMATTR InstName B1
SYMBOL voltage -2992 -688 R180
WINDOW 3 66 62 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 1 {0.5/FORCE_FREQ} 1n 1n {0.5/FORCE_FREQ} {1/FORCE_FREQ} {FORCE_NCYCLES})
SYMATTR InstName V2
SYMBOL res -1776 -1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 123
SYMBOL diode -800 -1472 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value Dideal
SYMBOL diode -736 -1376 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value Dideal
SYMBOL res -1312 -1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 20k
SYMBOL voltage -640 -1184 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
SYMATTR InstName V4
SYMATTR Value {VCLAMP}
SYMBOL voltage -464 -1296 R0
SYMATTR InstName V5
SYMATTR Value {VCLAMP}
SYMBOL res -1328 -1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1
SYMBOL bi -1312 -1088 R0
WINDOW 3 -109 158 Left 2
SYMATTR Value I=ddt(V(vcspark))*SQRT((V(RAMP_SIGNAL)-50)/(VRAMP_MAX-50))*CSPARK
SYMATTR InstName B2
SYMBOL ind -2256 -1072 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value 1.7µ
SYMBOL cap -1696 -1056 R0
SYMATTR InstName C1
SYMATTR Value 5.4p
SYMBOL cap -1552 -1072 R0
SYMATTR InstName C2
SYMATTR Value 8p
SYMBOL res -1552 -1216 R0
SYMATTR InstName R5
SYMATTR Value 10
TEXT -2184 -1232 Left 2 !.tran 2m
TEXT -2184 -1336 Left 2 !K L1 L2 0.47
TEXT -3096 -1296 Left 2 !.param FORCE_FREQ=351k\n.param FORCE_NCYCLES 20\n.param VCLAMP=36k\n.param VRAMP_MAX 450 ;.step param VRAMP_MAX list 100 200 300 400\n.param CSPARK=6p
TEXT -2896 -1408 Left 2 !.model Dideal D(Ron=1 Roff=1000Meg Vfwd=1)
